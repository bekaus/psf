<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>psf: psf::SpectralPeak Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="namespaces.html"><span>Namespace&nbsp;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespacepsf.html">psf</a>::<a class="el" href="namespacepsf_1_1_spectral_peak.html">SpectralPeak</a>
  </div>
</div>
<div class="contents">
<h1>psf::SpectralPeak Namespace Reference</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;typename FwdIter , typename MzExtractor , typename IntensityExtractor &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">PSF_EXPORT MzExtractor::result_type&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepsf_1_1_spectral_peak.html#ab29a9ed166905bcd64f4b22460b89889">fullWidthAtFractionOfMaximum</a> (const MzExtractor &amp;, const IntensityExtractor &amp;, FwdIter firstElement, FwdIter lastElement, const double fraction)</td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;typename FwdIter , typename IntensityExtractor &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">PSF_EXPORT <br class="typebreak"/>
IntensityExtractor::result_type&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepsf_1_1_spectral_peak.html#a6188fce7fa24aba6edca859fa16d4aed">height</a> (const IntensityExtractor &amp;, FwdIter firstElement, FwdIter lastElement)</td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;typename FwdIter , typename IntensityExtractor &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">PSF_EXPORT double&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepsf_1_1_spectral_peak.html#a2835edf124ea04665fef1872731798ea">lowness</a> (const IntensityExtractor &amp;, FwdIter firstElement, FwdIter lastElement)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Aggregates algorithms working on a spectral peak.</p>
<p>A spectral peak is a single peak in a mass spectrum; in contrary to a monoisotopic peak, which represents a whole isotope pattern.</p>
<p>A spectral peak is represented as a sequence of spectrum elements. The algorithms work with iterators on this sequence. The elements have to be in ascending order of their m/z values. There are no further requirements to constitute a sequence a spectral peak. For example, even a set of equiabundant elements can be seen as a spectral peak.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>psf::Peak </dd></dl>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ab29a9ed166905bcd64f4b22460b89889"></a><!-- doxytag: member="psf::SpectralPeak::fullWidthAtFractionOfMaximum" ref="ab29a9ed166905bcd64f4b22460b89889" args="(const MzExtractor &amp;, const IntensityExtractor &amp;, FwdIter firstElement, FwdIter lastElement, const double fraction)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MzExtractor::result_type fullWidthAtFractionOfMaximum </td>
          <td>(</td>
          <td class="paramtype">const MzExtractor &amp;&nbsp;</td>
          <td class="paramname"> <em>get_mz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const IntensityExtractor &amp;&nbsp;</td>
          <td class="paramname"> <em>get_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FwdIter&nbsp;</td>
          <td class="paramname"> <em>firstElement</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FwdIter&nbsp;</td>
          <td class="paramname"> <em>lastElement</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>fraction</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The full width at a fraction of the maximum of a spectral peak.</p>
<p>The most abundant element in a sequence of spectral elements is found. Coming from the left and right, the two elements which are nearest to the fraction of the abundance maximum are search: abundance fraction &lt;= element abundance. The two elements on both sides are then linearly interpolated with their neighboring elements just below the fraction of the maximum. (In case of fraction == element abundance, this is avoided.) The distance in m/z dimension between the two interpolated elements flanking the maximum is then returned as the full width at the fraction of the maximum.</p>
<p>For example, setting the fraction to 0.5 just returns the full width at half maximum.</p>
<p>The minimal requirements of the sequence are: </p>
<ul>
<li>At least one abundance maximum. If there are multiple maxima, the first such element is chosen. </li>
<li>At least one element below the fraction of the maximum on both flanks of the maximum. The maximum itself may be chosen as the element above the fraction.</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>firstElement</em>&nbsp;</td><td>Points to the first element of the sequences of spectral elements to be considered a peak. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lastElement</em>&nbsp;</td><td>Points to the last elmement of the sequences of spectral elements to be considered a peak. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fraction</em>&nbsp;</td><td>Has to be between 0.0 and 1.0, borders included. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The full width at the fraction of the maximum, in units of m/z.</dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>psf::PreconditionViolation</em>&nbsp;</td><td>Parameter fraction not in the required range. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="classpsf_1_1_starvation.html">psf::Starvation</a></em>&nbsp;</td><td>The sequence doesn't satisfy the minimal requirements.</td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Bernhard Kausler &lt;<a href="mailto:bernhard.kausler@iwr.uni-heidelberg.de">bernhard.kausler@iwr.uni-heidelberg.de</a>&gt; </dd></dl>

<p>Definition at line <a class="el" href="_spectrum_algorithm_8h_source.html#l00460">460</a> of file <a class="el" href="_spectrum_algorithm_8h_source.html">SpectrumAlgorithm.h</a>.</p>

<p>Referenced by <a class="el" href="_spectrum_algorithm_8h_source.html#l00318">psf::measureFullWidths()</a>.</p>

</div>
</div>
<a class="anchor" id="a6188fce7fa24aba6edca859fa16d4aed"></a><!-- doxytag: member="psf::SpectralPeak::height" ref="a6188fce7fa24aba6edca859fa16d4aed" args="(const IntensityExtractor &amp;, FwdIter firstElement, FwdIter lastElement)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IntensityExtractor::result_type height </td>
          <td>(</td>
          <td class="paramtype">const IntensityExtractor &amp;&nbsp;</td>
          <td class="paramname"> <em>get_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FwdIter&nbsp;</td>
          <td class="paramname"> <em>firstElement</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FwdIter&nbsp;</td>
          <td class="paramname"> <em>lastElement</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The height of a spectral peak.</p>
<p>The heighest abundance in a sequence of spectral elements is detected. This abundance is interpreted as the peak height.</p>
<p>The minimal requirements of the sequence are: </p>
<ul>
<li>At least one element.</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>firstElement</em>&nbsp;</td><td>Points to the first element of the sequences of spectral elements to be considered a peak. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lastElement</em>&nbsp;</td><td>Points to the last element of the sequences of spectral elements to be considered a peak. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The peak height, in units of the element abundance.</dd></dl>
<dl><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>psf::PreconditionViolation</em>&nbsp;</td><td>Minimal sequence requirements aren't met.</td></tr>
  </table>
  </dd>
</dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Bernhard Kausler &lt;<a href="mailto:bernhard.kausler@iwr.uni-heidelberg.de">bernhard.kausler@iwr.uni-heidelberg.de</a>&gt; </dd></dl>

<p>Definition at line <a class="el" href="_spectrum_algorithm_8h_source.html#l00372">372</a> of file <a class="el" href="_spectrum_algorithm_8h_source.html">SpectrumAlgorithm.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2835edf124ea04665fef1872731798ea"></a><!-- doxytag: member="psf::SpectralPeak::lowness" ref="a2835edf124ea04665fef1872731798ea" args="(const IntensityExtractor &amp;, FwdIter firstElement, FwdIter lastElement)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double lowness </td>
          <td>(</td>
          <td class="paramtype">const IntensityExtractor &amp;&nbsp;</td>
          <td class="paramname"> <em>get_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FwdIter&nbsp;</td>
          <td class="paramname"> <em>firstElement</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FwdIter&nbsp;</td>
          <td class="paramname"> <em>lastElement</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The lowness of a spectral peak.</p>
<p>The highest element in a sequence of spectral elements is detected and the two elements with the lowest abundance are searched; one on the left and one on the right of the maximum (the maximum itself can be selected). The more abundant peak of these two is chosen. One minus the ratio of this abundance to the maximum is called the 'peak lowness'.</p>
<p>An equiabundant sequence of spectral elements has a lowness of 0.0. In contrast, a maximum flanked by two elements with almost zero abundance has a lowness of almost 1.00.</p>
<p>The minimal requirements of the sequence are: </p>
<ul>
<li>At least one element. The lowness is then 0.0.</li>
</ul>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>firstElement</em>&nbsp;</td><td>Points to the first element of the sequences of spectral elements to be considered a peak. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lastElement</em>&nbsp;</td><td>Points to the last element of the sequences of spectral elements to be considered a peak. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The lowness is between 0.0 and 1.0, borders included.</dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Bernhard Kausler &lt;<a href="mailto:bernhard.kausler@iwr.uni-heidelberg.de">bernhard.kausler@iwr.uni-heidelberg.de</a>&gt; </dd></dl>

<p>Definition at line <a class="el" href="_spectrum_algorithm_8h_source.html#l00387">387</a> of file <a class="el" href="_spectrum_algorithm_8h_source.html">SpectrumAlgorithm.h</a>.</p>

<p>Referenced by <a class="el" href="_spectrum_algorithm_8h_source.html#l00318">psf::measureFullWidths()</a>.</p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Tue Oct 4 21:15:38 2011 for psf by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
